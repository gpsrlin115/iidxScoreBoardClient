import apiClient from './client';

/**
 * ğŸ“ í•™ìŠµ í¬ì¸íŠ¸: API í•¨ìˆ˜ë¥¼ ì™œ ë³„ë„ íŒŒì¼ë¡œ ë¶„ë¦¬í• ê¹Œìš”?
 *
 * ì´ìœ  1: ë‹¨ì¼ ì±…ì„ ì›ì¹™ (Single Responsibility Principle)
 *   - client.js  â†’ Axios ì¸ìŠ¤í„´ìŠ¤ "ì„¤ì •"ë§Œ ë‹´ë‹¹
 *   - auth.js    â†’ ì¸ì¦ ê´€ë ¨ API "í˜¸ì¶œ"ë§Œ ë‹´ë‹¹
 *   - scores.js  â†’ ìŠ¤ì½”ì–´ ê´€ë ¨ API "í˜¸ì¶œ"ë§Œ ë‹´ë‹¹
 *
 * ì´ìœ  2: ìœ ì§€ë³´ìˆ˜ê°€ ì‰¬ì›Œì§‘ë‹ˆë‹¤
 *   - ë°±ì—”ë“œ ì—”ë“œí¬ì¸íŠ¸ê°€ ë°”ë€Œë©´? â†’ ì´ íŒŒì¼ë§Œ ìˆ˜ì •!
 *   - ì»´í¬ë„ŒíŠ¸ ì½”ë“œëŠ” ì „í˜€ ê±´ë“œë¦´ í•„ìš” ì—†ìŠµë‹ˆë‹¤.
 *
 * ì´ìœ  3: ì¬ì‚¬ìš©ì„±
 *   - ì–´ëŠ ì»´í¬ë„ŒíŠ¸ì—ì„œë“  authApi.login() í•œ ì¤„ì´ë©´ ë©ë‹ˆë‹¤.
 */
export const authApi = {
  /**
   * ë¡œê·¸ì¸ ìš”ì²­
   *
   * ğŸ“ ë¬´ìŠ¨ ì¼ì´ ì¼ì–´ë‚˜ë‚˜ìš”?
   * 1. POST /api/auth/login ìœ¼ë¡œ { username, password } ì „ì†¡
   * 2. ë°±ì—”ë“œ ì¸ì¦ ì„±ê³µ ì‹œ â†’ ì„¸ì…˜ ì¿ í‚¤ë¥¼ ì‘ë‹µ í—¤ë”ì— ë‹´ì•„ ë°˜í™˜
   * 3. client.jsì˜ withCredentials: true ë•ë¶„ì—
   *    ë¸Œë¼ìš°ì €ê°€ ì¿ í‚¤ë¥¼ ìë™ìœ¼ë¡œ ì €ì¥í•©ë‹ˆë‹¤
   * 4. ì´í›„ ëª¨ë“  API ìš”ì²­ì— ì´ ì¿ í‚¤ê°€ ìë™ìœ¼ë¡œ í¬í•¨ë©ë‹ˆë‹¤
   *
   * ğŸ“ async/await íŒ¨í„´
   *   async í•¨ìˆ˜ëŠ” í•­ìƒ Promiseë¥¼ ë°˜í™˜í•©ë‹ˆë‹¤.
   *   awaitëŠ” "ì´ ì‘ì—…ì´ ëë‚  ë•Œê¹Œì§€ ê¸°ë‹¤ë ¤ë¼"ëŠ” ì˜ë¯¸ì…ë‹ˆë‹¤.
   *   â†’ ì„œë²„ ì‘ë‹µì´ ì˜¬ ë•Œê¹Œì§€ ë‹¤ìŒ ì¤„ë¡œ ë„˜ì–´ê°€ì§€ ì•ŠìŠµë‹ˆë‹¤.
   */
  login: async (username, password) => {
    const response = await apiClient.post('/auth/login', { username, password });
    return response.data;
  },

  /**
   * íšŒì›ê°€ì… ìš”ì²­
   *
   * ğŸ“ API ìŠ¤í™ì— ì•„ì§ ì—†ì§€ë§Œ ë°±ì—”ë“œ AuthServiceì— signup() ë©”ì„œë“œê°€ ìˆìŠµë‹ˆë‹¤.
   * í”„ë¡ íŠ¸ì—”ë“œì—ì„œ ë¯¸ë¦¬ êµ¬í˜„í•´ë‘ë©´ ë°±ì—”ë“œ ì—”ë“œí¬ì¸íŠ¸ê°€ ì¶”ê°€ë  ë•Œ ë°”ë¡œ ì—°ë™ë©ë‹ˆë‹¤.
   *
   * @param {{ username: string, email: string, password: string }} data
   */
  signup: async ({ username, email, password }) => {
    const response = await apiClient.post('/auth/signup', { username, email, password });
    return response.data;
  },

  /**
   * ë¡œê·¸ì•„ì›ƒ ìš”ì²­
   *
   * ğŸ“ í´ë¼ì´ì–¸íŠ¸ì—ì„œ ì§ì ‘ ì¿ í‚¤ë¥¼ ì§€ìš°ì§€ ì•Šë‚˜ìš”?
   * â†’ ì„œë²„ì— ìš”ì²­í•´ì•¼ í•©ë‹ˆë‹¤! ì´ìœ :
   *   - ì„¸ì…˜ ì •ë³´ëŠ” "ì„œë²„"ê°€ ê´€ë¦¬í•©ë‹ˆë‹¤
   *   - ì„œë²„ ì„¸ì…˜ì„ ë¬´íš¨í™”í•´ì•¼ ì§„ì§œ ë¡œê·¸ì•„ì›ƒì…ë‹ˆë‹¤
   *   - í´ë¼ì´ì–¸íŠ¸ ì¿ í‚¤ë§Œ ì§€ìš°ë©´ ì„œë²„ ì„¸ì…˜ì´ ë‚¨ì•„ ë³´ì•ˆ ìœ„í—˜ì´ ìƒê¹ë‹ˆë‹¤
   */
  logout: async () => {
    await apiClient.post('/auth/logout');
  },

  /**
   * í˜„ì¬ ë¡œê·¸ì¸í•œ ì‚¬ìš©ì ì •ë³´ ì¡°íšŒ
   *
   * ğŸ“ ì•± ì‹œì‘ ì‹œ ì™œ ì´ APIë¥¼ í˜¸ì¶œí• ê¹Œìš”?
   * - í˜ì´ì§€ë¥¼ ìƒˆë¡œê³ ì¹¨í•˜ë©´ JavaScript ë©”ëª¨ë¦¬(Zustand Store)ê°€ ì´ˆê¸°í™”ë©ë‹ˆë‹¤
   * - í•˜ì§€ë§Œ ì¿ í‚¤(ì„¸ì…˜)ëŠ” ë¸Œë¼ìš°ì €ì— ê·¸ëŒ€ë¡œ ë‚¨ì•„ ìˆìŠµë‹ˆë‹¤!
   * - ê·¸ë˜ì„œ ì•± ì‹œì‘ ì‹œ ì„œë²„ì— "ë‚´ê°€ ì•„ì§ ë¡œê·¸ì¸ ìƒíƒœì¸ê°€?" í™•ì¸í•©ë‹ˆë‹¤
   * - ì´ê²ƒì„ "ì„¸ì…˜ ë³µì›(Session Restoration)"ì´ë¼ê³  í•©ë‹ˆë‹¤
   */
  getCurrentUser: async () => {
    const response = await apiClient.get('/users/me');
    return response.data;
  },
};
